<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="A compassionate AI memory companion for elderly people, helping organize routines, preserve memories, and stay connected with family.">
    <title>Aegis AI</title>
    <link rel="stylesheet" href="style.css">
    <script src="translations.js?v=3"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="app-container">
        <!-- Persistent Header -->
        <header class="global-header">
            <h1 class="header-title">Aegis AI</h1>
            <p class="header-subtitle" data-i18n="header_subtitle">Your space to organize routines, preserve memories,
                and stay connected.</p>
        </header>

        <!-- Tab Navigation -->
        <nav class="tab-navigation">
            <button class="tab-button active" data-tab="home" data-i18n="tab_home">Home</button>
            <button class="tab-button" data-tab="chat" data-i18n="tab_chat">Chat</button>
            <button class="tab-button" data-tab="routines" data-i18n="tab_routines">Routines</button>
            <button class="tab-button" data-tab="memories" data-i18n="tab_memories">Memories</button>
            <button class="tab-button" data-tab="family" data-i18n="tab_family">Family</button>
            <button class="tab-button" data-tab="notes" data-i18n="tab_notes">Notes</button>
            <button class="tab-button" data-tab="profile" data-i18n="tab_profile">Profile</button>
        </nav>

        <!-- Tab Contents -->
        <main class="tab-container">
            <!-- HOME TAB -->
            <section id="home-tab" class="tab-content active">
                <div class="page-content">
                    <div class="home-two-col">
                        <!-- LEFT COLUMN: Routines ¬∑ Memories ¬∑ Family -->
                        <div class="home-left-col">

                            <!-- Today's Routines Card -->
                            <div class="home-card">
                                <div class="home-card-header">
                                    <h3 data-i18n="home_routines_heading">üìÖ Today's Routines</h3>
                                </div>
                                <div class="home-card-body" id="home-routines">
                                    <!-- Will be populated by JavaScript -->
                                </div>
                                <div class="home-card-footer">
                                    <button class="text-button" onclick="switchTab('routines')"
                                        data-i18n="home_routines_link">Go to Routines</button>
                                </div>
                            </div>

                            <!-- Recent Memories Card -->
                            <div class="home-card">
                                <div class="home-card-header">
                                    <h3 data-i18n="home_memories_heading">üì∏ Recent Memories</h3>
                                </div>
                                <div class="home-card-body" id="home-memories">
                                    <!-- Will be populated by JavaScript -->
                                </div>
                                <div class="home-card-footer">
                                    <button class="text-button" onclick="switchTab('memories')"
                                        data-i18n="home_memories_link">View All Memories</button>
                                </div>
                            </div>

                            <!-- Family Updates Card -->
                            <div class="home-card">
                                <div class="home-card-header">
                                    <h3 data-i18n="home_family_heading">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family Updates</h3>
                                </div>
                                <div class="home-card-body" id="home-family">
                                    <!-- Will be populated by JavaScript -->
                                </div>
                                <div class="home-card-footer">
                                    <button class="text-button" onclick="switchTab('family')"
                                        data-i18n="home_family_link">Go to Family</button>
                                </div>
                            </div>

                        </div><!-- /home-left-col -->

                        <!-- RIGHT COLUMN: Notes ¬∑ Chat -->
                        <div class="home-right-col">

                            <!-- Quick Notes Card -->
                            <div class="home-card quick-notes-card" id="quick-notes-home-card">
                                <div class="home-card-header quick-notes-header">
                                    <h3 data-i18n="home_notes_heading">üìù Quick Notes</h3>
                                    <button class="qn-add-btn" onclick="openQuickNoteModal(event)"
                                        data-i18n-title="home_notes_add_title" title="Add a note">Ôºã</button>
                                </div>
                                <div class="home-card-body" id="home-notes-preview">
                                    <!-- Populated by JS -->
                                </div>
                                <div class="home-card-footer">
                                    <button class="text-button" onclick="switchTab('notes')"
                                        data-i18n="home_notes_link">View All Notes</button>
                                </div>
                            </div>

                            <!-- Chat with Aegis AI Card -->
                            <div class="home-card chat-prompt-card" onclick="switchTab('chat')">
                                <div class="home-card-header">
                                    <h3 data-i18n="home_chat_heading">üí¨ Chat with Aegis AI</h3>
                                </div>
                                <div class="home-card-body">
                                    <p class="chat-prompt-text" id="chat-prompt" data-i18n="home_chat_prompt">Hello! I'd
                                        love to hear a story today. How are you feeling?</p>
                                </div>
                            </div>

                        </div><!-- /home-right-col -->
                    </div><!-- /home-two-col -->
                </div><!-- /page-content -->
            </section>

            <!-- NOTES TAB -->
            <section id="notes-tab" class="tab-content">
                <div class="page-content">
                    <div class="tab-header">
                        <h2 class="tab-title" data-i18n="notes_title">üìù My Notes</h2>
                        <button class="add-button" id="new-note-btn" data-i18n="notes_add">+ New Note</button>
                    </div>
                    <div id="notes-grid" class="notes-grid">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </section>

            <!-- ROUTINES TAB -->
            <section id="routines-tab" class="tab-content">
                <div class="page-content">
                    <div class="tab-header">
                        <div class="view-toggle">
                            <button class="toggle-button active" data-view="today"
                                data-i18n="routines_view_today">Today</button>
                            <button class="toggle-button" data-view="all" data-i18n="routines_view_all">All
                                Routines</button>
                        </div>
                        <button class="add-button" id="add-routine-btn" data-i18n="routines_add">Add Routine</button>
                    </div>
                    <div class="content-grid" id="routines-list">
                        <!-- Routines will be populated here -->
                    </div>
                </div>
            </section>

            <!-- MEMORIES TAB -->
            <section id="memories-tab" class="tab-content">
                <div class="page-content">
                    <div class="tab-header">
                        <h2 class="tab-title" data-i18n="memories_title">My Memories</h2>
                        <div class="view-toggle" id="memory-filter-toggle">
                            <button class="toggle-button active" data-filter="all" data-i18n="memories_filter_all">All
                                Memories</button>
                            <button class="toggle-button" data-filter="manual" data-i18n="memories_filter_pure">Pure
                                Memories</button>
                            <button class="toggle-button" data-filter="chat"
                                data-i18n="memories_filter_chat">Chat-Derived Memories</button>
                        </div>
                        <button class="add-button" id="add-memory-btn" data-i18n="memories_add">Add Memory</button>
                    </div>
                    <div class="content-grid" id="memories-list">
                        <!-- Memories will be populated here -->
                    </div>
                </div>
            </section>

            <!-- FAMILY TAB -->
            <section id="family-tab" class="tab-content">
                <div class="page-content">
                    <div class="tab-header">
                        <h2 class="tab-title" data-i18n="family_title">Family Members</h2>
                        <button class="add-button" id="add-family-btn" data-i18n="family_add">Add Family Member</button>
                    </div>
                    <div class="content-grid" id="family-list">
                        <!-- Family members will be populated here -->
                    </div>
                </div>
            </section>

            <!-- CHAT TAB -->
            <section id="chat-tab" class="tab-content">
                <div class="page-content" style="height:100%; display:flex; flex-direction:column; padding-bottom:0;">
                    <div class="chat-container">
                        <div class="chat-header">
                            <div class="chat-header-main">
                                <div class="chat-avatar">ü§ñ</div>
                                <div class="chat-info">
                                    <h2 data-i18n="chat_title">Aegis Companion</h2>
                                    <p class="status" data-i18n="chat_status">Always here for you</p>
                                </div>
                            </div>
                            <div class="chat-actions">
                                <button class="text-button delete" id="clear-chat-btn" data-i18n="chat_clear">Clear
                                    Chat</button>
                            </div>
                        </div>
                        <div class="chat-messages" id="chat-messages">
                            <div class="message ai-message">
                                <div class="message-avatar">ü§ñ</div>
                                <div class="message-content">
                                    <p data-i18n="chat_greeting">Hello! I'm here to listen and chat with you. Feel free
                                        to share your stories, memories, or anything on your mind. I'd love to hear
                                        about your day or reminisce about your favorite moments!</p>
                                    <span class="message-time" data-i18n="chat_just_now">Just now</span>
                                </div>
                            </div>
                        </div>
                        <div class="chat-input-container">
                            <input type="text" id="chat-input" data-i18n-placeholder="chat_placeholder"
                                placeholder="Type a message or share a memory..." autocomplete="off">
                            <button class="send-button" id="send-button" data-i18n="chat_send">Send</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- PROFILE TAB -->
            <section id="profile-tab" class="tab-content">
                <div class="page-content">
                    <div class="profile-container">
                        <h2 class="tab-title" style="margin-bottom: var(--spacing-xl);" data-i18n="profile_title">My
                            Profile</h2>
                        <form id="profile-form">

                            <!-- SECTION 1: Identity & Context -->
                            <div class="form-section">
                                <div class="form-section-header">
                                    <h3 data-i18n="sec_identity">Identity &amp; Context</h3>
                                </div>
                                <div class="form-group">
                                    <label for="profile-preferred-name" data-i18n="lbl_preferred_name">Preferred Name
                                        <span class="required-star">*</span></label>
                                    <input type="text" id="profile-preferred-name"
                                        data-i18n-placeholder="ph_preferred_name"
                                        placeholder="What would you like to be called?" required>
                                    <span class="field-hint" data-i18n="hint_preferred_name">Used in chat responses and
                                        reminders</span>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="profile-pronouns" data-i18n="lbl_pronouns">Pronouns <span
                                                class="optional-tag" data-i18n="opt_tag">optional</span></label>
                                        <select id="profile-pronouns">
                                            <option value="" data-i18n="pronouns_select">Select‚Ä¶</option>
                                            <option value="he/him" data-i18n="pronouns_he">He / Him</option>
                                            <option value="she/her" data-i18n="pronouns_she">She / Her</option>
                                            <option value="they/them" data-i18n="pronouns_they">They / Them</option>
                                            <option value="other" data-i18n="pronouns_other">Other</option>
                                            <option value="prefer_not" data-i18n="pronouns_prefer">Prefer not to say
                                            </option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label data-i18n="lbl_languages_spoken">Languages Spoken <span
                                                class="optional-tag" data-i18n="opt_tag">optional</span></label>
                                        <div class="lang-chip-grid" id="languages-spoken-grid">
                                            <!-- Populated by JS from ALL_SPOKEN_LANGUAGES -->
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="profile-cultural-bg" data-i18n="lbl_cultural_bg">Cultural Background
                                        <span class="optional-tag" data-i18n="opt_tag">optional</span></label>
                                    <input type="text" id="profile-cultural-bg" data-i18n-placeholder="ph_cultural_bg"
                                        placeholder="e.g. traditions, holidays, heritage">
                                </div>
                                <div class="form-group">
                                    <label for="profile-app-language" data-i18n="lbl_app_language">App Language <span
                                            class="optional-tag" data-i18n="opt_tag">optional</span></label>
                                    <select id="profile-app-language">
                                        <!-- Populated by JS from SUPPORTED_APP_LANGUAGES -->
                                    </select>
                                    <span class="field-hint" data-i18n="hint_app_language">Controls all buttons, tabs,
                                        labels, and the AI chat
                                        language. Changes apply after saving.</span>
                                </div>
                            </div>

                            <!-- SECTION 2: Cognitive & Support Context -->
                            <div class="form-section">
                                <div class="form-section-header">
                                    <h3 data-i18n="sec_cognitive">Cognitive &amp; Support Context</h3>
                                </div>
                                <div class="form-group">
                                    <label for="profile-memory-level" data-i18n="lbl_memory_level">Memory Support Level
                                        <span class="required-star">*</span></label>
                                    <select id="profile-memory-level" required>
                                        <option value="" data-i18n="mem_level_select">Select level‚Ä¶</option>
                                        <option value="mild" data-i18n="mem_level_mild">Mild ‚Äì occasional reminders
                                            helpful</option>
                                        <option value="moderate" data-i18n="mem_level_moderate">Moderate ‚Äì regular
                                            gentle prompting</option>
                                        <option value="advanced" data-i18n="mem_level_advanced">Advanced ‚Äì consistent
                                            structured support</option>
                                    </select>
                                    <span class="field-hint" data-i18n="hint_memory_level">Helps Aegis adjust
                                        conversation pacing and support
                                        style</span>
                                </div>
                                <div class="form-group">
                                    <label for="profile-comfort-topics" data-i18n="lbl_comfort_topics">Comfort Topics
                                        <span class="optional-tag" data-i18n="opt_tag">optional</span></label>
                                    <textarea id="profile-comfort-topics" rows="2"
                                        data-i18n-placeholder="ph_comfort_topics"
                                        placeholder="Topics that bring calm or joy (e.g. gardening, music, grandchildren)"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="profile-avoid-topics" data-i18n="lbl_avoid_topics">Topics to Avoid <span
                                            class="optional-tag" data-i18n="opt_tag">optional</span></label>
                                    <textarea id="profile-avoid-topics" rows="2" data-i18n-placeholder="ph_avoid_topics"
                                        placeholder="Topics that may cause distress (e.g. news, specific events)"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="profile-triggers" data-i18n="lbl_triggers">Common Triggers <span
                                            class="optional-tag" data-i18n="opt_tag">optional</span></label>
                                    <textarea id="profile-triggers" rows="2" data-i18n-placeholder="ph_triggers"
                                        placeholder="Notes about situations that may cause anxiety or agitation"></textarea>
                                </div>
                            </div>

                            <!-- SECTION 3: Daily Rhythm & Preferences -->
                            <div class="form-section">
                                <div class="form-section-header">
                                    <h3 data-i18n="sec_daily_rhythm">Daily Rhythm &amp; Preferences</h3>
                                    <span class="section-optional-badge" data-i18n="opt_tag">optional</span>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="profile-day-type" data-i18n="lbl_day_type">Time of Day
                                            Preference</label>
                                        <select id="profile-day-type">
                                            <option value="" data-i18n="day_no_pref">No preference</option>
                                            <option value="morning" data-i18n="day_morning">üåÖ Morning Person</option>
                                            <option value="evening" data-i18n="day_evening">üåô Evening Person</option>
                                            <option value="afternoon" data-i18n="day_afternoon">‚òÄÔ∏è Afternoon Person
                                            </option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="profile-reminder-style" data-i18n="lbl_reminder_style">Preferred
                                            Reminder Style</label>
                                        <select id="profile-reminder-style">
                                            <option value="gentle" data-i18n="reminder_gentle">üå∏ Gentle</option>
                                            <option value="direct" data-i18n="reminder_direct">üìã Direct</option>
                                            <option value="encouraging" data-i18n="reminder_encouraging">‚ú® Encouraging
                                            </option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- SECTION 4: Basic Information -->
                            <div class="form-section">
                                <div class="form-section-header">
                                    <h3 data-i18n="sec_basic_info">Basic Information</h3>
                                    <span class="section-optional-badge" data-i18n="opt_tag">optional</span>
                                </div>
                                <div class="form-group">
                                    <label for="profile-name" data-i18n="lbl_full_name">Full Name</label>
                                    <input type="text" id="profile-name" data-i18n-placeholder="ph_full_name"
                                        placeholder="E.g. John Doe">
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="profile-age" data-i18n="lbl_age">Age</label>
                                        <input type="number" id="profile-age" data-i18n-placeholder="lbl_age"
                                            placeholder="Age" min="1" max="120">
                                    </div>
                                    <div class="form-group">
                                        <label for="profile-gender" data-i18n="lbl_gender">Gender</label>
                                        <select id="profile-gender">
                                            <option value="" data-i18n="pronouns_select">Select‚Ä¶</option>
                                            <option value="male" data-i18n="gender_male">Male</option>
                                            <option value="female" data-i18n="gender_female">Female</option>
                                            <option value="other" data-i18n="pronouns_other">Other</option>
                                            <option value="prefer_not_to_say" data-i18n="pronouns_prefer">Prefer not to
                                                say</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="profile-address" data-i18n="lbl_address">Home Address</label>
                                    <input type="text" id="profile-address" data-i18n-placeholder="ph_address"
                                        placeholder="E.g. 123 Maple Street, Springfield">
                                </div>
                            </div>

                            <!-- SECTION 5: Emergency Contacts -->
                            <div class="form-section">
                                <div class="form-section-header">
                                    <h3 data-i18n="sec_emergency">Emergency Contacts</h3>
                                </div>
                                <div id="emergency-contacts-list">
                                    <!-- Dynamic contact entries rendered by JS -->
                                </div>
                                <button type="button" class="add-item-button profile-add-btn"
                                    id="add-emergency-contact-btn" data-i18n="profile_add_contact">
                                    + Add Emergency Contact
                                </button>
                            </div>

                            <!-- SECTION 6: Medical Information -->
                            <div class="form-section">
                                <div class="form-section-header">
                                    <h3 data-i18n="sec_medical">Medical Information</h3>
                                    <span class="section-optional-badge" data-i18n="opt_tag">optional</span>
                                </div>
                                <div class="form-group">
                                    <label for="profile-medical" data-i18n="lbl_medical">Medical Conditions</label>
                                    <textarea id="profile-medical" rows="2" data-i18n-placeholder="ph_medical"
                                        placeholder="Any medical conditions, allergies, or medications‚Ä¶"></textarea>
                                </div>
                                <div class="form-group">
                                    <label data-i18n="lbl_doctors">Doctors / Medical Providers</label>
                                    <div id="doctors-list">
                                        <!-- Dynamic doctor entries rendered by JS -->
                                    </div>
                                    <button type="button" class="add-item-button profile-add-btn" id="add-doctor-btn"
                                        data-i18n="profile_add_doctor">
                                        + Add Doctor
                                    </button>
                                </div>
                            </div>

                            <!-- SECTION 7: Personal Details & Accessibility -->
                            <div class="form-section">
                                <div class="form-section-header">
                                    <h3 data-i18n="sec_personal">Personal Details</h3>
                                    <span class="section-optional-badge" data-i18n="opt_tag">optional</span>
                                </div>
                                <div class="form-group">
                                    <label for="profile-hobbies" data-i18n="lbl_hobbies">Hobbies &amp; Interests</label>
                                    <textarea id="profile-hobbies" rows="2" data-i18n-placeholder="ph_hobbies"
                                        placeholder="What do you enjoy doing? (e.g. Gardening, Chess)"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="profile-notes" data-i18n="lbl_add_notes">Additional Notes</label>
                                    <textarea id="profile-notes" rows="2" data-i18n-placeholder="ph_add_notes"
                                        placeholder="Anything else you'd like Aegis to remember?"></textarea>
                                </div>
                            </div>

                            <!-- SECTION 8: Emotional Anchors -->
                            <div class="form-section">
                                <div class="form-section-header">
                                    <h3 data-i18n="sec_emotional">Emotional Anchors</h3>
                                    <span class="section-optional-badge" data-i18n="opt_tag">optional</span>
                                </div>
                                <p class="section-desc" data-i18n="emotional_desc">These help Aegis naturally reference
                                    the people and places that
                                    matter most to you.</p>
                                <div class="form-group">
                                    <label for="profile-important-people" data-i18n="lbl_important_people">Important
                                        People</label>
                                    <textarea id="profile-important-people" rows="2"
                                        data-i18n-placeholder="ph_important_people"
                                        placeholder="e.g. My daughter Sarah, my friend Tom from church"></textarea>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="profile-music-era" data-i18n="lbl_music_era">Favourite Music
                                            Era</label>
                                        <input type="text" id="profile-music-era" data-i18n-placeholder="ph_music_era"
                                            placeholder="e.g. 1960s Motown, Classical">
                                    </div>
                                    <div class="form-group">
                                        <label for="profile-favourite-place" data-i18n="lbl_fav_place">Favourite
                                            Place</label>
                                        <input type="text" id="profile-favourite-place"
                                            data-i18n-placeholder="ph_fav_place"
                                            placeholder="e.g. The cottage by the lake">
                                    </div>
                                </div>
                            </div>

                            <!-- SECTION 9: Accessibility Enhancements -->
                            <div class="form-section">
                                <div class="form-section-header">
                                    <h3 data-i18n="sec_accessibility">Accessibility &amp; Display</h3>
                                    <span class="section-optional-badge" data-i18n="opt_tag">optional</span>
                                </div>
                                <div class="toggle-row">
                                    <div class="toggle-item">
                                        <div class="toggle-label-group">
                                            <span class="toggle-label" data-i18n="toggle_high_contrast">High Contrast
                                                Mode</span>
                                            <span class="toggle-desc" data-i18n="toggle_high_contrast_desc">Stronger
                                                colour contrast for easier reading</span>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="profile-high-contrast">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="toggle-item">
                                        <div class="toggle-label-group">
                                            <span class="toggle-label" data-i18n="toggle_reduced_motion">Reduced
                                                Animation</span>
                                            <span class="toggle-desc" data-i18n="toggle_reduced_motion_desc">Calmer
                                                experience with fewer moving elements</span>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="profile-reduced-motion">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="toggle-item">
                                        <div class="toggle-label-group">
                                            <span class="toggle-label" data-i18n="toggle_tts">Text-to-Speech</span>
                                            <span class="toggle-desc" data-i18n="toggle_tts_desc">Aegis reads responses
                                                aloud</span>
                                        </div>
                                        <label class="switch">
                                            <input type="checkbox" id="profile-tts">
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                                <div class="form-row" style="margin-top: var(--spacing-lg);">
                                    <div class="form-group">
                                        <label for="profile-voice-speed" data-i18n="lbl_voice_speed">Voice Speed</label>
                                        <select id="profile-voice-speed">
                                            <option value="normal" data-i18n="speed_normal">Normal</option>
                                            <option value="slow" data-i18n="speed_slow">Slow</option>
                                            <option value="fast" data-i18n="speed_fast">Fast</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="profile-font-size" data-i18n="lbl_font_size">Font Size</label>
                                        <select id="profile-font-size">
                                            <option value="normal" data-i18n="speed_normal">Normal</option>
                                            <option value="big" data-i18n="size_big">Big</option>
                                            <option value="small" data-i18n="size_small">Small</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="profile-theme">Colour Theme</label>
                                    <select id="profile-theme">
                                        <option value="default">Normal (Default)</option>
                                        <option value="ocean">Ocean Breeze</option>
                                        <option value="forest">Forest Calm</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Bottom spacer so content isn't hidden behind the floating button -->
                            <div style="height: 5rem;"></div>

                        </form>
                    </div><!-- /profile-container -->
                </div><!-- /page-content -->
            </section>

        </main>
    </div>

    <!-- ROUTINE MODAL -->
    <div id="routine-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2 id="routine-modal-title" data-i18n="routine_modal_title_add">Add Routine</h2>
                <button class="close-button" id="close-routine-modal">√ó</button>
            </div>
            <div class="modal-body">
                <form id="routine-form">
                    <input type="hidden" id="routine-id">
                    <div class="form-group">
                        <label for="routine-name" data-i18n="routine_label_name">Routine Name</label>
                        <input type="text" id="routine-name" required data-i18n-placeholder="routine_ph_name"
                            placeholder="e.g. Take Medication">
                    </div>
                    <div class="form-group">
                        <label for="routine-time" data-i18n="routine_label_time">Time</label>
                        <input type="time" id="routine-time" required>
                    </div>
                    <div class="form-group">
                        <label data-i18n="routine_label_days">Days of Week</label>
                        <div class="day-selector">
                            <button type="button" class="day-button" data-day="Mon">M</button>
                            <button type="button" class="day-button" data-day="Tue">T</button>
                            <button type="button" class="day-button" data-day="Wed">W</button>
                            <button type="button" class="day-button" data-day="Thu">Th</button>
                            <button type="button" class="day-button" data-day="Fri">F</button>
                            <button type="button" class="day-button" data-day="Sat">Sa</button>
                            <button type="button" class="day-button" data-day="Sun">Su</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="routine-description" data-i18n="routine_label_desc">Description</label>
                        <textarea id="routine-description" rows="2" data-i18n-placeholder="routine_ph_desc"
                            placeholder="Details..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="routine-reminder" data-i18n="routine_label_reminder">Reminder</label>
                        <select id="routine-reminder">
                            <option value="0" data-i18n="reminder_none">None</option>
                            <option value="5" data-i18n="reminder_5">5 minutes before</option>
                            <option value="10" data-i18n="reminder_10">10 minutes before</option>
                            <option value="15" data-i18n="reminder_15">15 minutes before</option>
                            <option value="30" data-i18n="reminder_30">30 minutes before</option>
                            <option value="60" data-i18n="reminder_60">1 hour before</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="routine-media" data-i18n="routine_label_media">Media (Image/Video)</label>
                        <input type="file" id="routine-media" accept="image/*,video/*">
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="cancel-button" id="cancel-routine"
                            data-i18n="modal_cancel">Cancel</button>
                        <button type="submit" class="save-button" data-i18n="routine_save">Save Routine</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- MEMORY MODAL -->
    <div id="memory-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2 id="memory-modal-title" data-i18n="memory_modal_title_add">Add Memory</h2>
                <button class="close-button" id="close-memory-modal">√ó</button>
            </div>
            <div class="modal-body">
                <form id="memory-form">
                    <input type="hidden" id="memory-id">
                    <div class="form-group">
                        <label for="memory-title" data-i18n="memory_label_title">Title</label>
                        <input type="text" id="memory-title" required data-i18n-placeholder="memory_ph_title"
                            placeholder="e.g. Summer Vacation 2024">
                    </div>
                    <div class="form-group">
                        <label for="memory-date" data-i18n="memory_label_date">Date</label>
                        <input type="date" id="memory-date">
                    </div>
                    <div class="form-group">
                        <label for="memory-description" data-i18n="memory_label_desc">Description</label>
                        <textarea id="memory-description" rows="3" data-i18n-placeholder="memory_ph_desc"
                            placeholder="What happened?"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="memory-media" data-i18n="memory_label_media">Photo/Video</label>
                        <input type="file" id="memory-media" accept="image/*,video/*">
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="cancel-button" id="cancel-memory"
                            data-i18n="modal_cancel">Cancel</button>
                        <button type="submit" class="save-button" data-i18n="memory_save">Save Memory</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- FAMILY MODAL -->
    <div id="family-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2 id="family-modal-title" data-i18n="family_modal_title_add">Add Family Member</h2>
                <button class="close-button" id="close-family-modal">√ó</button>
            </div>
            <div class="modal-body">
                <form id="family-form">
                    <input type="hidden" id="family-id">
                    <div class="form-section">
                        <h3 data-i18n="family_section_basic">Basic Information</h3>
                        <div class="form-group">
                            <label for="family-name" data-i18n="family_label_name">Name</label>
                            <input type="text" id="family-name" required placeholder="E.g. Jane Doe">
                        </div>
                        <div class="form-group">
                            <label for="family-relation" data-i18n="family_label_relation">Relation</label>
                            <input type="text" id="family-relation" required placeholder="E.g. Sister">
                        </div>
                        <div class="form-group">
                            <label for="family-photo" data-i18n="family_label_photo">Photo URL</label>
                            <input type="text" id="family-photo" placeholder="Photo URL">
                        </div>
                        <div class="form-group">
                            <label for="family-birthday" data-i18n="family_label_birthday">Birthday</label>
                            <input type="date" id="family-birthday">
                        </div>
                    </div>
                    <div class="form-section">
                        <h3 data-i18n="family_section_contact">Contact Information</h3>
                        <div class="form-group">
                            <label for="family-phone" data-i18n="family_label_phone">Phone Number</label>
                            <input type="tel" id="family-phone" placeholder="Phone Number">
                        </div>
                        <div class="form-group">
                            <label for="family-address" data-i18n="family_label_address">Address</label>
                            <input type="text" id="family-address" placeholder="Address">
                        </div>
                    </div>
                    <div class="form-section">
                        <h3 data-i18n="family_section_extra">Additional Information</h3>
                        <div class="form-group">
                            <label for="family-notes" data-i18n="family_label_notes">Notes</label>
                            <textarea id="family-notes" rows="2" placeholder="Likes, dislikes, stories..."></textarea>
                        </div>
                        <div class="form-group">
                            <label data-i18n="family_label_activities">Favorite Activities</label>
                            <div id="family-activities-list"></div>
                            <button type="button" class="add-item-button" id="add-activity"
                                data-i18n="family_add_activity">Add Activity</button>
                        </div>
                        <div class="form-group">
                            <label data-i18n="family_label_dates">Important Dates</label>
                            <div id="family-dates-list"></div>
                            <button type="button" class="add-item-button" id="add-date" data-i18n="family_add_date">Add
                                Date</button>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="cancel-button" id="cancel-family"
                            data-i18n="modal_cancel">Cancel</button>
                        <button type="submit" class="save-button" data-i18n="family_save">Save Family Member</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- MEMORY CONFIRMATION MODAL -->
    <div id="memory-confirm-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2 data-i18n="mem_confirm_title">Memory Detected</h2>
                <button class="close-button" onclick="closeMemoryConfirmModal()">√ó</button>
            </div>
            <div class="modal-body">
                <p data-i18n="mem_confirm_msg">I noticed you just shared something meaningful. Would you like me to save
                    this to your memories?</p>
                <div id="memory-confirm-content"
                    style="background: var(--color-gray-100); padding: var(--spacing-md); border-radius: var(--radius-md); margin: var(--spacing-md) 0;">
                    <!-- Memory preview will be here -->
                </div>
            </div>
            <div class="modal-actions">
                <button class="cancel-button" onclick="closeMemoryConfirmModal()"
                    data-i18n="mem_confirm_dismiss">Dismiss</button>
                <button class="save-button" id="confirm-save-memory-btn" data-i18n="mem_confirm_save">Save to
                    Memories</button>
            </div>
        </div>
    </div>

    <!-- NOTE EDITOR MODAL (used by Notes tab for Create + Edit) -->
    <div id="note-editor-modal" class="modal-overlay">
        <div class="modal modal-lg">
            <div class="modal-header">
                <h2 id="note-editor-title" data-i18n="note_modal_title">‚úèÔ∏è New Note</h2>
                <button class="close-button" onclick="closeNoteEditor()">√ó</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="note-editor-id">
                <div class="form-group">
                    <label for="note-editor-name" data-i18n="note_label_title">Title</label>
                    <input type="text" id="note-editor-name" data-i18n-placeholder="note_ph_title"
                        placeholder="Give your note a title‚Ä¶" maxlength="100" required>
                </div>
                <div class="form-group" style="margin-bottom:0;">
                    <label for="note-editor-body" data-i18n="note_label_content">Content</label>
                    <textarea id="note-editor-body" rows="9" data-i18n-placeholder="note_ph_content"
                        placeholder="Write anything here ‚Äì a reminder, thought, or moment to remember‚Ä¶"></textarea>
                </div>
            </div>
            <div class="modal-actions">
                <button class="cancel-button" onclick="closeNoteEditor()" data-i18n="modal_cancel">Cancel</button>
                <button class="save-button" id="note-editor-save-btn" onclick="saveNoteFromEditor()"
                    data-i18n="note_save">Save Note</button>
            </div>
        </div>
    </div>

    <!-- QUICK NOTE MODAL -->
    <div id="quick-note-modal" class="modal-overlay">
        <div class="modal modal-sm">
            <div class="modal-header">
                <h2 data-i18n="note_modal_title">‚úèÔ∏è New Note</h2>
                <button class="close-button" onclick="closeQuickNoteModal()">√ó</button>
            </div>
            <div class="modal-body">
                <form id="quick-note-form" onsubmit="saveQuickNote(event)">
                    <div class="form-group">
                        <label for="qn-title" data-i18n="note_label_title">Title</label>
                        <input type="text" id="qn-title" data-i18n-placeholder="note_ph_quick_title"
                            placeholder="E.g. Doctor appointment reminder" maxlength="80">
                    </div>
                    <div class="form-group">
                        <label for="qn-content" data-i18n="note_label_note">Note</label>
                        <textarea id="qn-content" rows="5" data-i18n-placeholder="note_ph_quick_content"
                            placeholder="Want to remember something? Write it here‚Ä¶" required></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-actions">
                <button class="cancel-button" onclick="closeQuickNoteModal()" data-i18n="modal_cancel">Cancel</button>
                <button class="save-button" onclick="saveQuickNote()" data-i18n="note_save">Save Note</button>
            </div>
        </div>
    </div>

    <!-- THEME ANIMATION OVERLAY (canvas, pointer-events:none) -->
    <canvas id="theme-anim-canvas" class="theme-anim-canvas"></canvas>

    <!-- FLOATING SAVE PROFILE BUTTON -->
    <button id="floating-save-profile-btn" class="floating-save-btn"
        onclick="document.getElementById('profile-form').requestSubmit()" title="Save Profile">
        <span class="fsb-icon">üíæ</span>
        <span class="fsb-label" data-i18n="profile_save_label">Save Profile</span>
    </button>

    <!-- TOAST NOTIFICATION -->
    <div id="toast-container" class="toast-container" aria-live="polite"></div>

    <!-- DELETE ENTRY CONFIRMATION MODAL -->
    <div id="delete-entry-modal" class="modal-overlay">
        <div class="modal modal-sm">
            <div class="modal-header">
                <h2 data-i18n="delete_modal_title">Confirm Deletion</h2>
                <button class="close-button" onclick="cancelDeleteEntry()">√ó</button>
            </div>
            <div class="modal-body">
                <p id="delete-entry-message" data-i18n="delete_modal_msg">Are you sure you want to delete this?</p>
            </div>
            <div class="modal-actions">
                <button class="cancel-button" onclick="cancelDeleteEntry()"
                    data-i18n="delete_cancel_btn">Cancel</button>
                <button class="delete-confirm-button" id="confirm-delete-entry-btn"
                    data-i18n="delete_confirm_btn">Confirm Delete</button>
            </div>
        </div>
    </div>

    <script src="script.js?v=3"></script>
</body>

</html>